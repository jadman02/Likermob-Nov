<!DOCTYPE html>
<html>
    <!-- Required meta tags-->
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!-- Your app title -->
    <title>Likermob</title>
    <!-- Path to Framework7 Library CSS-->
    <link rel="stylesheet" href="css/framework7.css">
    <!-- Path to your custom app styles-->
    <link rel="stylesheet" href="css/my-app.css">
    <!-- Icons-->
    <link rel="stylesheet" href="css/pe-icon-7-stroke.css">

<!-- Optional - Adds useful class to manipulate icon font display -->
<link rel="stylesheet" href="css/helper.css">

<style>





.green {
	color:#007aff;
	
}
     



     .height{height:200px;}
     .hide {display:none;}
     .show {display:block;}

.slider-slide-business {
  background: #fff;
  box-sizing: border-box;
  border: 1px solid #ccc;
  width:50%;
}
.slider-slide-business span {
  text-align:center;
  display:block;
  margin: 20px;
  font-size:21px;
}
.slider-container-business {
  height: 120px;
  margin: 35px 0;
}
     
      #map-canvas {
        height: 100%;
        width:100%;
        margin: 0px;
        padding: 0px;
         position:absolute; 
  top: 40px; 
  left: 0; 
  z-index: -1;
      }
    </style>
    


<!--Place the code below everywhere where you want an ad to appear. -->




  </head>
  <body>
    <!-- Status bar overlay for full screen mode (PhoneGap) -->
    <div class="statusbar-overlay"></div>
    
    <!-- Panels Overlay -->
  <div class="panel-overlay"></div>
 
  <!-- Left Panel with Reveal effect -->
  <div class="panel panel-left panel-reveal" style="background-color:#3b5998;">
    


    <div class="content-block" style="text-align:center;margin:0 auto;color:white;">
      
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-100" style="padding:20px;"><div id="profilepic"></div></div>
      </div>

      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-100" style="padding:20px;" onclick="pages()"><i class="pe-7s-home pe-2x"></i> Find Deals</div>
      </div>
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-100" style="padding:20px;" onclick="pages()"><i class="pe-7s-like2 pe-2x"></i> My Deals</div>
      </div>
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <a href="#" onclick="favourites()"><div class="col-100" style="padding:20px;"><i class="pe-7s-star pe-2x"></i> Favourite List</div></a>
      </div>
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-50" style="padding:20px;" onclick="pages()"><i class="pe-7s-plus pe-2x"></i><br/>Add Deal</div>
       <a href="location.html"> <div class="col-50" style="padding:20px;"><i class="pe-7s-photo-gallery pe-2x"></i><br/>Manage Deals</div></a>
      </div>
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-50" style="padding:20px;" onclick="pages()"><i class="pe-7s-mail pe-2x"></i><br/>Contact</div>
        <div class="col-50" style="padding:20px;"><i class="pe-7s-share pe-2x"></i><br/>Share</div>
      </div>
      <div class="row">
        <div class="col-50" style="padding:20px;" onclick="pages()"><i class="pe-7s-config pe-2x"></i><br/>Settings</div>
        <div class="col-50" style="padding:20px;"><i class="pe-7s-video pe-2x"></i><br/>Help</div>
      </div>
      </div>
    
    
   
  </div>
    
      <!-- Left Panel with Reveal effect -->
  <div class="panel panel-right panel-reveal" style="background-color:#ff8000;">
    


    <div class="content-block" style="text-align:center;margin:0 auto;color:white;">
      
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-100" style="padding:20px;"><i class="pe-7s-serach pe-5x"></i></div>
      </div>

      
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-50" style="padding:20px;" onclick="pages()"><i class="pe-7s-plus pe-2x"></i><br/>Add Deal</div>
        <div class="col-50" style="padding:20px;"><i class="pe-7s-photo-gallery pe-2x"></i><br/>Manage Deals</div>
      </div>
      <div class="row" style="border-bottom: 1px solid #ccc;">
        <div class="col-50" style="padding:20px;" onclick="pages()"><i class="pe-7s-mail pe-2x"></i><br/>Contact</div>
        <div class="col-50" style="padding:20px;"><i class="pe-7s-share pe-2x"></i><br/>Share</div>
      </div>
      <div class="row">
        <div class="col-50" style="padding:20px;" onclick="pages()"><i class="pe-7s-config pe-2x"></i><br/>Settings</div>
        <div class="col-50" style="padding:20px;"><i class="pe-7s-video pe-2x"></i><br/>Help</div>
      </div>
      </div>
    
    
   
  </div>
    
    <!-- Views -->
    <div class="views">
      <!-- Your main view, should have "view-main" class -->
      <div class="view view-main">
        <!-- Top Navbar-->
        <div class="navbar" style="border:0;height:35px;">
          <div class="navbar-inner">
            <!-- We need cool sliding animation on title element, so we have additional "sliding" class -->


           <div class="left link open-panel" data-panel="left">
<a href="#" class="button link" style="margin:0px;border:0;margin-left:-10px;"><i class="icon pe-7s-menu pe-lg" style="color:#3b5998;font-weight:bold;"></i>
<a href="#" class="link badge" style="margin:0px;border:#3b5998 1px solid;color:#3b5998;background-color:white;height:20px;">8</a>



        </div>

  
  

  
<div class="center"><img src="img/likermobhorizontal.png" width="93.5" height="23.65" alt="title"></div>




                             <div class="right">
            <a href="#" class="button link" style="margin:0px;border:0;"><i class="icon pe-7s-star pe-lg" style="color:#3b5998"></i></a>
<a href="#" data-panel="right" class="button link open-panel" style="margin:0px;border:0;margin-right:-10px;"><i class="icon pe-7s-search pe-lg"  style="color:#3b5998"></i></a>
            
            
            
            


                

                </div>      
            


       



  
        </div>

        </div>

 

 

        <!-- Pages container, because we use fixed-through navbar and toolbar, it has additional appropriate classes-->
        <div class="pages navbar-through toolbar-through" style="padding:0px;margin:0px;">
          <!-- Page, "data-page" contains page name -->
          <div data-page="index" class="page toolbar-fixed" style="padding:0px;margin:0px;">
            <!-- Scrollable page content -->
            
            <div class="toolbar messagebar" data-max-height="500" id="hometoolbar">
  <div class="toolbar-inner">
   <i class="pe-7s-camera pe-lg" style="margin-right:15px;"></i> <textarea id="commentinput" placeholder="Add Comment"></textarea><a href="#" class="link button" style="border: 1px solid #c8c8cd;margin-bottom:8px;margin-right:5px;height:28px;width:50px;border-radius:5px;background-color:#3b5998;padding: 3px 8px 3px;"><i class="pe-7s-like2 pe-lg" style="width:30px;margin: 0 auto;color:white;"></i></a><a href="#" class="link button" style="padding: 3px 8px 3px;margin-bottom:8px;height:28px;width:50px;border-radius:5px;background-color:#ff8000;border: 1px solid #c8c8cd;"><i class="pe-7s-like2 pe-lg pe-rotate-180" style="width:30px;margin: 0 auto;color:white;"></i></a>
  </div>
</div>   
  
            <div class="page-content pull-to-refresh-content homecontent" style="padding:0px;margin:0px;margin-top:44px;">

 <div class="pull-to-refresh-layer">

      <div class="preloader"></div>
      <div class="pull-to-refresh-arrow"></div>
    </div>

    
    
    
<div class="list-block media-list" id="resultlist" style="margin-top:-25px;">




 



<div id="status"></div>
<div id="photoresult"></div>


<p id="geolocation"></p>

<!--
  Below we include the Login Button social plugin. This button uses
  the JavaScript SDK to present a graphical Login button that triggers
  the FB.login() function when clicked.
-->



<div id="buttons"></div>

<ul id="add_container" style="border:none;"></ul>

<a href="#" class="button" onclick="favouritesPage()">favouritesPage()</a>
<a href="#" class="button" onclick="mylikes()">mylikes()</a>
<a href="#" class="button" onclick="clearEntries()">Clear Entries</a>
<a href="#" class="button" onclick="openSearchHome();">Search Location</a>
<ul id="result" style="overflow:hidden;background-color:transparent;"></ul></div>
<div style="text-align:center;margin:0 auto;width:100%;color:#ff8000" id="loader-container">
        <span class="preloader" style="width:31px; height:31px"></span>
        LOADING
        </div>
<p class="buttons-row">
<div id="tempImg" style="visibility:hidden"></div>

<a href="#" class="button button-big button-fill load_previous" style="margin:10px;display:none;">Previous</a>


<a href="#" class="button button-big button-fill load_more" style="margin:10px;display:none;"> More</a>

</p>









            </div>
          </div>
        </div>
        





     

      
 


        
      </div>
    </div>
    
    
    
    
    

    

    

    
    
       <!--cordova.js is automatically injected by the Cordova build process-->

<script type="text/javascript" src="phonegap.js"></script>
    

<script src="js/openfb.js"></script>
 
<script>

     // Defaults to sessionStorage for storing the Facebook token
     //openFB.init({appId: '129670517205110'});

    //  Uncomment the line below to store the Facebook token in localStorage instead of sessionStorage
      openFB.init({appId: '129670517205110', tokenStore: window.localStorage});

    function login() {
        openFB.login(
                function(response) {
                    if(response.status === 'connected') {
                        alert('Facebook login succeeded, got access token: ' + response.authResponse.token);
						document.getElementById('status').innerHTML = 'user is logged';
						localStorage.setItem("auth_token", response.authResponse.token);
						localStorage.setItem("register", "register");
						//mainView.loadPage('location.html');
						 openFB.api({
            path: '/me',
            success: function(data) {
                //console.log(JSON.stringify(data));
                localStorage.setItem("user_name", data.name);
               // alert(data.name);
                //alert('http://graph.facebook.com/' + data.id + '/picture?type=small');
               localStorage.setItem("uid", data.id);
            },
            error: errorHandler});
						mainView.showNavbar();
						
						
                    } else {
                        alert('Facebook login failed: ' + response.error);
                    }
                }, {scope: 'email'});
    }

function publishStreamLogin() {
        openFB.login(
                function(response) {
                    if(response.status === 'connected') {
                        alert('Facebook login succeeded, got access token: ' + response.authResponse.token);
						
                    } else {
                        alert('Facebook login failed: ' + response.error);
                    }
                }, {scope: 'publish_stream'});
    }

function managePagesLogin() {
	alert('manage_pages login');
        openFB.login(
                function(response) {
                    if(response.status === 'connected') {
                        alert('Facebook login succeeded, got access token: ' + response.authResponse.token);
localStorage.setItem("manage_pages", "manage_pages");	
pages();
                    } else {
                        alert('Facebook login failed: ' + response.error);
                    }
                }, {scope: 'manage_pages'});
    }

function userLikesLogin() {
	alert('user_likes login');
        openFB.login(
                function(response) {
                    if(response.status === 'connected') {
                        alert('Facebook login succeeded, got access token: ' + response.authResponse.token);
localStorage.setItem("user_likes", "user_likes");
mylikes();

                    } else {
                        alert('Facebook login failed: ' + response.error);
                    }
                }, {scope: 'user_likes'});
    }


        function facebookPhotos(page_id) {
        
     
                  
        var photos_list = [];
        var track_click = 0;

        
        
        openFB.api({
            path: '/'+ page_id +'?fields=albums.fields(photos.limit(10).fields(picture,source))&limit=10&offset=0&',
            success: function(response) {
                
                
               
                for (i = 0; i < response.albums.data.length; i++) {
                
                for (j = 0; j < response.albums.data[i].photos.data.length; j++) {
                
                	//$$( '#pages_list' ).append('<li><img style="wi'dth:50%;float:left;padding:20px;" src="'+ response.albums.data[i].photos.data[j].picture +'"/></li>');
               	photos_list.push('<div class="slider-slide"><img onclick="setCover('+response.albums.data[i].photos.data[j].picture+');moveCover();" src="'+ response.albums.data[i].photos.data[j].picture +'" height="130" /></div>');
                
                
                

                	
                }
                }
track_click++;

var photos_slider = photos_list.join("");               
                
                
                          
var modal = myApp.modal({
    title: 'Add Photo',
    text: 'Include a photo with your deal?',
    afterText:  '<div class="slider-container" style="width: auto; margin:5px -15px">'+
                  '<div class="slider-pagination"></div>'+
                  '<div class="slider-wrapper">'+ photos_slider +
                  '</div>'+
                '</div>',
    buttons: [
      {
        text: 'Cancel'
      },
      {
        text: 'More',
        bold: true,
        onClick: function () {
          
          var offset = track_click*10;
          alert(offset);
          
          openFB.api({
            path: '/'+ page_id +'?fields=albums.fields(photos.limit(10).fields(picture,source))&limit=10&offset='+ offset +'&',
            success: function(response) {
                
                var photos_list = [];
               
                for (i = 0; i < response.albums.data.length; i++) {
                
                for (j = 0; j < response.albums.data[i].photos.data.length; j++) {
                
                	//$$( '#pages_list' ).append('<li><img style="wi'dth:50%;float:left;padding:20px;" src="'+ response.albums.data[i].photos.data[j].picture +'"/></li>');
               	
               	photos_list.push('<div class="slider-slide"><img src="'+ response.albums.data[i].photos.data[j].picture +'" height="130" /></div>');
                	
                }
                }
          
          track_click++;
          var photos_slider = photos_list.join("");   
          
          $$(".slider-slide").remove();
          $$(".slider-wrapper").append(photos_slider);
          mySlider.update(modal);
          
            },
            error: errorHandler});
          
          
        }
      },
    ]
  })
  myApp.slider($$(modal).find('.slider-container'), {pagination: '.slider-pagination'});
                
            },
            error: errorHandler});
    }


    function share(value,page_id,url,title) {
        
        openFB.api({
            method: 'POST',
            path: '/me/photos',
            params: {
                url: url,
                message: value + "          |          " + title,
                place:page_id
            },
            success: function() {
                myApp.alert('Thanks for sharing!', 'Your message was posted on Facebook.');
            },
            error: errorHandler});
    }

    function mylikes() {
        var page_id = [];
        openFB.api({
            path: '/me/likes',
            success: function(response) {
                for (i = 0; i < response.data.length; i++){page_id.push(response.data[i].id);}
            favList(page_id);
            	
            },
            error: errorHandler});
    }

function like(post_id) {
        
        openFB.api({
            method: 'POST',
            path: '/' + post_id + '/likes',
            error: errorHandler});
        
        
        
        
    }
    
    
    
    function comment(post_id,say) {
        
        openFB.api({
        method: 'POST',
        path: '/' + post_id + '/comments',
        params: {
            message: say
        },
        success: function() {
                alert('Posted your comment:' + say);
            },
        error: function() {alert('error not posted on facebook');}
        	
        });
        
    }

var click = 0;

    function getComments() {
        
        $$( "#commentloader" ).removeClass( "hide" );
        $$( "#chatloader" ).addClass( "hide" ); 

        var start;
        var finish;
        
        
        openFB.api({
        path: '/174238599281322_824826047555904/comments?summary=1&',
        success: function(response) {
        $$( "#commentloader" ).addClass( "hide" );
        $$( "#chatloader" ).removeClass( "hide" ); 
        
var last = response.summary.total_count;
var cycles = Math.ceil(last / 5);
if (click == 0) {start = 0; finish = 5;}
else if (click == (cycles -1)) {start = click*5; finish = last-2;alert('reached');}
else {start = click*5; finish = (click + 1) * 5;}


        
        
        click ++;
                


        $$( '#commentlist' ).append('<div style="width:100%"><a href="#" style="z-index:100;margin-right:5px;height:40px;width:40px;margin:0 auto;border-radius:50%;background-color:transparent;margin-top:20px;" class="button disabled"><i class="pe-7s-chat pe-2x" style="margin-left:-2px;margin-top:5px;"></i></a></div>');        
  
                for (i = start; i < finish; i++) {

var created_time = response.data[i].created_time;
var year_c = created_time.substring(0, 4);
var month_c = created_time.substring(5, 7);
var day_c = created_time.substring(8, 10);
var time_c = created_time.substring(11, 19);


var date = new Date(month_c + "/" + day_c + "/" + year_c + " " + time_c); // some mock date
var milliseconds = date.getTime(); 

var datetoday = new Date();
var offset = datetoday.getTimezoneOffset() * 60;

var unix = Math.round(milliseconds) + offset;

var d = new Date(unix);
var month = new Array(12);
month[0] = "Jan";
month[1] = "Feb";
month[2] = "Mar";
month[3] = "Apr";
month[4] = "May";
month[5] = "Jun";
month[6] = "Jul";
month[7] = "Aug";
month[8] = "Sep";
month[9] = "Oct";
month[10] = "Nov";
month[11] = "Dec";

var day_name = new Array(7);
day_name[0] = "Sunday";
day_name[1] = "Monday";
day_name[2] = "Tuesday";
day_name[3] = "Wednesday";
day_name[4] = "Thursday";
day_name[5] = "Friday";
day_name[6] = "Saturday";

var month_name = month[d.getUTCMonth()];
var weekday_name = day_name[d.getUTCDay()];
var day = d.getUTCDate();
var year = d.getUTCFullYear();
var hours = d.getUTCHours();
var minutes = d.getUTCMinutes();
if (minutes < 10) {minutes = minutes + "0"} 

var firstdate = weekday_name + ", " + month_name + " " + day ;
var seconddate = hours + ":" + minutes;             
            









                $$( '#commentlist' ).append('<div class="messages-date">'+ firstdate +'<span> '+ seconddate +'</span></div><div class="row"><div class="col-20" style="height:60px;"><a href="#" style="z-index:100;float:left;margin:0 auto;border:0;background-color:transparent;margin-top:20px;height:60px;" class="button"><img src="http://graph.facebook.com/'+response.data[i].from.id+'/picture?width=30&height=30" style="border-radius:50%;"/></a></div><div class="col-80"><div class="messages-date" style="float:left;margin:0;padding:0;"><span>'+ response.data[i].from.name +'</span></div><div style="background-color:#e5e5ea;padding:10px;border-radius:10px;margin-top:20px;"><div style="clear:both;">'+response.data[i].message+'</div><div style="float:right;margin-top:15px;" class="messages-date"><i class="pe-7s-like2"></i>'+response.data[i].like_count+'</div></div></div></div>');
          	
 
              	
                }
          var img = new Image();
     img.src = $$( '.homecontent' ).css('background-image').replace(/url\(|\)$|"/ig, '');      
        var windowsize = $$(window).width();
	var height_image = ((img.height/img.width) * windowsize);
	var liHeight = $$( "#content-block" ).height();
	var resultheight = liHeight + height_image;
	 $$( '#result' ).css( 'height', resultheight + 'px' );
                
            },
        error: function() {alert('error not posted on facebook');}
        	
        });
        
    }


function setManagePages(){

	    openFB.api({
            path: '/me/permissions',
            success: function(response) {
                
//manage_pages not granted
if (response.data[0].manage_pages == undefined) {
	
	alert('dont have permission gonna redirect now');
                	managePagesLogin();
};
//manage_pages granted
if (response.data[0].manage_pages == 1) {};
               
            },
            error: errorHandler});
	
	
	
}



function pages() {
        
        
var manage_pages = localStorage.getItem('manage_pages');
if (manage_pages) {
	
	
	$$("#result li").remove();
	$$("#add_container li").remove();
	$$("#pages_list li").remove();
	$$("#loader-container").show();
	



	
 dbDeal();
		
	
	
	
getMyPages();
	
	
	functionEmpty(pages_list); 
	
	
	
}
else{
	
managePagesLogin();
	
}
        
        




	



        
        
        
        
    }

function getMyPages(){
	
		openFB.api({
        path: '/me/accounts',
        success: function(response) {
               
                
                var pages_list = [];
              
                
                
                $$("#add-loader-container").hide();
                
                
                for (i = 0; i < response.data.length; i++) {
                
                
                
                pages_list.push("999999"+ response.data[i].id +"999999");
               //$$( '#pages_list' ).append('<li class="a_'+ response.data[i].id +' total_list" ><div class="item-content"><div class="item-media"></div><div class="item-inner"><div class="item-title">'+ +'</div><div class="item-after"><i class="pe-7s-close-circle"></i></div></div><div></li>');
                
                //$$( '#pages_list' ).append('<option onclick="getCover('+ response.data[i].id +')" value="'+ response.data[i].id +'" data-option-image="http://graph.facebook.com/'+ response.data[i].id +'/picture?width=20&height=20">'+ response.data[i].name +'</option>');
                
                $$( '#pages_list' ).append('<li onclick="getCover(\''+ response.data[i].id  +'\',\''+ response.data[i].access_token  +'\')"><label class="label-radio item-content"><!-- Checked by default --><input type="radio" name="my-radio" value="Movies"><div class="item-media"><img src="http://graph.facebook.com/'+ response.data[i].id +'/picture?width=20&height=20" style="height:20px;width:20px;"/></div><div class="item-inner"><div class="item-title">'+ response.data[i].name +'</div></div></label></li>');
                
                	
                }
              
              
               
               
                
            },
        error: function() {alert('error not posted on facebook');}
        	
        });
        
}

    function revoke() {
        openFB.revokePermissions(
                function() {
                    alert('Permissions revoked');
                },
                errorHandler);
    }

    function logout() {
        openFB.logout(
                function() {
                    alert('Logout successful');
                },
                errorHandler);
    }

    function errorHandler(error) {
        alert(error.message);
    }

</script>    
<!-- Path to geolocation-->



    <script type="text/javascript" src="js/geolocation.js"></script>
    <!-- Path to Framework7 Library JS-->
    <script type="text/javascript" src="js/framework7.min.js"></script>

    <!-- Path to your app js-->
    <script type="text/javascript" src="js/my-app.js"></script>
    
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
      <script type="text/javascript">
            app.initialize1();
        </script>
        
  </body>
</html> 
